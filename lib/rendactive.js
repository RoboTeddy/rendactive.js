// Generated by CoffeeScript 1.4.0
(function() {

  this.rendactive = function(template, createDataTemplate) {
    var createStream, data, dataTemplate, eventMap, fragment, latestData;
    eventMap = {};
    createStream = function(selector) {
      var bus;
      bus = new Bacon.Bus();
      eventMap[selector] = bus.push;
      return bus;
    };
    dataTemplate = createDataTemplate(createStream);
    latestData = null;
    data = Bacon.combineTemplate(dataTemplate);
    data.onValue(function(v) {
      return latestData = v;
    });
    fragment = Spark.render(function() {
      var html;
      html = Spark.isolate(function() {
        var ctx, stop;
        ctx = Meteor.deps.Context.current;
        stop = data.changes().onValue(function() {
          return ctx.invalidate();
        });
        ctx.onInvalidate(stop);
        return template(latestData);
      });
      return Spark.attachEvents(eventMap, html);
    });
    return {
      fragment: fragment,
      dataTemplate: dataTemplate
    };
  };

}).call(this);
